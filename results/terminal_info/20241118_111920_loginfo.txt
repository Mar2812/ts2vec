2024-11-18 11:19:34,661 - INFO - 训练样本分布: target
0.0    218
1.0    218
Name: count, dtype: int64
2024-11-18 11:19:34,704 - INFO - 连续特征已标准化
2024-11-18 11:19:34,710 - INFO - 预处理后的 result_array 形状: (436, 10, 4)
2024-11-18 11:19:34,737 - INFO - 连续特征已标准化
2024-11-18 11:19:34,748 - INFO - 预处理后的 result_array 形状: (720, 10, 4)
2024-11-18 11:19:34,785 - INFO - 连续特征已标准化
2024-11-18 11:19:34,791 - INFO - 预处理后的 result_array 形状: (776, 10, 4)
2024-11-18 11:19:34,888 - INFO - 连续特征已标准化
2024-11-18 11:19:34,940 - INFO - 预处理后的 result_array 形状: (436, 15, 17)
2024-11-18 11:19:35,058 - INFO - 连续特征已标准化
2024-11-18 11:19:35,103 - INFO - 预处理后的 result_array 形状: (720, 15, 17)
2024-11-18 11:19:35,185 - INFO - 连续特征已标准化
2024-11-18 11:19:35,234 - INFO - 预处理后的 result_array 形状: (776, 15, 17)
2024-11-18 11:19:35,261 - INFO - 连续特征已标准化
2024-11-18 11:19:35,270 - INFO - 预处理后的 result_array 形状: (436, 5, 9)
2024-11-18 11:19:35,296 - INFO - 连续特征已标准化
2024-11-18 11:19:35,312 - INFO - 预处理后的 result_array 形状: (720, 5, 9)
2024-11-18 11:19:35,452 - INFO - 连续特征已标准化
2024-11-18 11:19:35,469 - INFO - 预处理后的 result_array 形状: (776, 5, 9)
2024-11-18 11:19:35,616 - INFO - 数据加载时间: 15.414700269699097秒
2024-11-18 11:19:35,617 - INFO - 训练数据形状: (436, 10, 4)
2024-11-18 11:19:42,316 - ERROR - Expected 2D array, got 1D array instead:
array=[-0.38072147 -0.99977337 -1.0793303  -1.00019079 -0.76073505 -1.09639434
 -0.99978463 -1.00044591 -0.99978554  0.72881349 -0.99996956 -0.94398561
 -0.68558281 -0.99990959 -0.99961016  0.55407408 -0.01956893 -0.99962889
 -0.74108179 -0.99997292 -0.99994531 -0.94347244 -1.00012899  1.00007638
 -1.00003901 -0.0430249  -0.99995309 -0.0810037  -1.00025045 -0.99976935
 -1.00031231 -0.67817719 -0.99979937 -1.26442841 -1.00009836  1.00007638
 -1.00015755 -0.99990448  1.00007638 -1.00014952 -1.55875035 -0.99978376
 -1.00011335 -0.94377898 -0.69120652 -0.99997208 -1.00002957 -1.6716126
 -0.99978691 -1.00019241 -0.99991315 -0.99983007 -1.00001755 -0.99984088
 -0.81996622 -0.99962889 -0.99989141 -0.99975735 -0.20474075 -0.99995843
 -0.04052416 -0.92963573 -0.69756717 -0.99988824 -0.99981324 -1.24885902
 -1.00026565 -0.65989389 -0.99996282  1.00007638 -0.99998704 -0.99968662
  0.08161609 -1.00002703 -1.00013295 -1.00003901 -0.99990082 -0.99991042
 -0.99995403 -1.00021689 -0.69808413 -0.99993653 -1.09630641  0.30979589
  0.81514295 -0.9998277  -1.24676851 -1.00023227 -1.06860794 -0.99957717
  1.00007638 -0.84111342 -0.81054527 -1.0001957  -0.99962889 -1.21480471
 -0.99962889  0.00700037 -0.99970843 -1.00003901 -0.99956555 -1.00016957
 -0.99981969 -0.04225232 -0.13264191 -0.99984663 -1.00007987 -0.99975514
 -0.99975167 -0.99978519 -0.9998252  -1.00023227 -0.99979587 -0.99972468
 -0.99991147 -0.64711082 -1.00025506 -0.99997484 -1.22025402 -0.99973352
  0.99993062 -1.00023227 -1.08588144 -0.97951609 -0.99979594 -1.42648621
 -1.379298   -0.99982635 -1.40854285 -1.00012748 -0.99990332 -1.00003901
  1.26548263 -0.99985551 -1.00017803 -1.00000383 -0.74912649 -0.9998718
 -0.99998378 -1.00009559 -1.00045921 -0.99985669 -0.99975686 -0.42137318
  0.43088186 -1.01982673 -0.9997956  -0.67432018 -1.00014983 -0.99988807
 -0.59800064 -1.00026125 -1.00009973 -0.85348451 -0.0694888  -1.00012519
 -0.75255177 -1.00030955  0.03422077 -0.973056   -0.99995109 -1.00012221
 -0.99969996 -1.00013041 -0.9998215  -0.99968953 -1.9233492  -1.00003901
 -0.93158473 -1.0000106  -1.89933464 -0.9998023  -0.99998642 -0.99981832
 -0.99976776  0.19935951  0.49372555 -0.99995803 -1.69335885 -1.05613433
 -0.99991435 -1.00030808 -0.65265864 -0.39955402 -0.99962889  1.00007638
 -1.00035581 -0.99985097 -1.0000956  -0.99983298 -1.00023227 -1.00015243
 -0.99983952 -0.69497014 -0.34024658 -1.00012926 -1.00008726 -1.00007983
 -1.00016161 -0.99988066 -1.00020959 -0.9999114  -0.78693686 -0.99983624
 -0.99972944 -0.43725824 -0.99975509 -1.00007523 -1.78124222 -0.99980171
 -0.15227262 -0.99987424 -0.34052977 -0.9997661  -0.99977352 -0.90182132
 -0.36886902  0.21074788  0.90507574  0.99964458  2.18237148  1.00004482
  0.67446097  0.99989727 -1.00023227 -0.2986648   1.00011969  0.99975938
 -0.99962889  1.00007638  0.99995398 -0.04081865  0.99985221  0.99992505
  0.68169453  0.99980227  1.16775674  1.00020185  0.99996246  1.16262377
 -0.36015182 -0.81996622  1.00027365  1.00025266  0.99967465  1.00007638
  1.00007638  0.99989462 -0.09790195  0.29343712 -0.5144737  -0.59425477
  0.07091429  0.99981164  1.00000597  0.51540076  1.76858883 -0.3067663
  1.00010147 -0.30558283  1.00007678  0.99993386  0.99993062  0.56854555
  0.99980865  1.13811155  1.40896694  1.00019971  0.99993529  0.99971715
  0.99998275  0.99988248  0.0887691   0.35375498  1.00010552  0.99988601
  2.09881229  0.99990955  0.99962793  0.99977817  0.99975381  0.06416676
  0.9999776   1.00004091  0.33508751  1.00002685  1.93500695  0.8874137
  0.99973021  0.99989943 -0.19313789  0.99970968 -0.39376933  1.00007638
  0.99994347  1.60447332  0.99996933  0.99995129  0.99966369  1.00019422
  0.76409683 -1.00023227  0.99970042  0.86314372  2.03828846  0.88354157
  0.99999458  0.99988217 -0.6991436  -0.71323511  1.563159    0.99982557
 -0.12739856  0.99991351  0.99976223  0.92573889  0.99993062  0.99998271
  1.01223997  2.33785231  0.99974525  0.99975166  1.00015369  1.00016051
 -0.16928276  0.999781    0.99980619  1.17352935  2.04946598  0.99997226
  0.99978166  0.99988464  1.00002778  0.974374    0.45780317 -0.28653313
 -0.99962889 -0.90721907  1.00015364  1.36304632  1.00007638  1.00019743
  1.00008756  1.00028092  0.99997435  1.00008257  0.29573996  1.00008854
  0.31904489  0.3363191  -0.86678801  1.00007638  0.99995177  0.99996442
  1.00018303  1.00008089 -0.08602023  1.42394545  0.99962828  1.00024497
  1.19059515 -0.3791344  -0.2453848   1.00000232 -0.0810037   1.53630192
  1.15136714  0.99991662  0.99983161 -1.00003901 -0.97951609  0.08935724
  0.52074672  1.29865365  0.99981611  1.70249492  1.00009216  1.00007638
  1.00022357  1.12332768  0.44729244  1.32659035  0.99959884  1.27180464
 -0.5697714  -0.91594361  1.84832403  0.99982919  1.61508908  1.3037837
  0.99984747  0.99983021  1.0002021  -0.3427175   1.00007638  0.99992401
  0.99988646  1.00023696  0.9431184   0.9999304   1.15704838  1.70540312
  0.92039986  1.00001753  1.00005928  0.99990001  0.99978901  1.00005276
  1.37000999  0.99981023  1.00019798  1.08241911  0.50881486  2.09932598
  0.25710892  1.0001235   1.75815113  2.59392016  0.99990063  1.8531625
  1.20618456  0.99993062  0.79675456  2.00199651  0.83764165  0.9998375
  0.77182475  1.00007053  0.99973244  1.33063691  0.99983629  0.69450581
  1.38143626  1.0000594  -0.06292232  0.99979879].
Reshape your data either using array.reshape(-1, 1) if your data has a single feature or array.reshape(1, -1) if it contains a single sample.
Traceback (most recent call last):
  File "C:\Users\chao_ma02\Desktop\work\ts2vec\user_embedding.py", line 298, in <module>
    encode_and_evaluate(model_diaoyong, diaoyong_features_train, diaoyong_features_test, diaoyong_features_oot, labels_train, labels_test, labels_oot, "diaoyong")
  File "C:\Users\chao_ma02\Desktop\work\ts2vec\user_embedding.py", line 233, in encode_and_evaluate
    y_score_train, eval_metrics_train = eval_classification(
  File "C:\Users\chao_ma02\Desktop\work\ts2vec\tasks\classification.py", line 56, in eval_classification
    auprc = average_precision_score(test_labels_onehot, y_score)
  File "d:\Users\chao_ma02\AppData\Local\anaconda3\envs\normal\lib\site-packages\sklearn\utils\_param_validation.py", line 213, in wrapper
    return func(*args, **kwargs)
  File "d:\Users\chao_ma02\AppData\Local\anaconda3\envs\normal\lib\site-packages\sklearn\metrics\_ranking.py", line 268, in average_precision_score
    return _average_binary_score(
  File "d:\Users\chao_ma02\AppData\Local\anaconda3\envs\normal\lib\site-packages\sklearn\metrics\_base.py", line 80, in _average_binary_score
    y_score = check_array(y_score)
  File "d:\Users\chao_ma02\AppData\Local\anaconda3\envs\normal\lib\site-packages\sklearn\utils\validation.py", line 1050, in check_array
    raise ValueError(msg)
ValueError: Expected 2D array, got 1D array instead:
array=[-0.38072147 -0.99977337 -1.0793303  -1.00019079 -0.76073505 -1.09639434
 -0.99978463 -1.00044591 -0.99978554  0.72881349 -0.99996956 -0.94398561
 -0.68558281 -0.99990959 -0.99961016  0.55407408 -0.01956893 -0.99962889
 -0.74108179 -0.99997292 -0.99994531 -0.94347244 -1.00012899  1.00007638
 -1.00003901 -0.0430249  -0.99995309 -0.0810037  -1.00025045 -0.99976935
 -1.00031231 -0.67817719 -0.99979937 -1.26442841 -1.00009836  1.00007638
 -1.00015755 -0.99990448  1.00007638 -1.00014952 -1.55875035 -0.99978376
 -1.00011335 -0.94377898 -0.69120652 -0.99997208 -1.00002957 -1.6716126
 -0.99978691 -1.00019241 -0.99991315 -0.99983007 -1.00001755 -0.99984088
 -0.81996622 -0.99962889 -0.99989141 -0.99975735 -0.20474075 -0.99995843
 -0.04052416 -0.92963573 -0.69756717 -0.99988824 -0.99981324 -1.24885902
 -1.00026565 -0.65989389 -0.99996282  1.00007638 -0.99998704 -0.99968662
  0.08161609 -1.00002703 -1.00013295 -1.00003901 -0.99990082 -0.99991042
 -0.99995403 -1.00021689 -0.69808413 -0.99993653 -1.09630641  0.30979589
  0.81514295 -0.9998277  -1.24676851 -1.00023227 -1.06860794 -0.99957717
  1.00007638 -0.84111342 -0.81054527 -1.0001957  -0.99962889 -1.21480471
 -0.99962889  0.00700037 -0.99970843 -1.00003901 -0.99956555 -1.00016957
 -0.99981969 -0.04225232 -0.13264191 -0.99984663 -1.00007987 -0.99975514
 -0.99975167 -0.99978519 -0.9998252  -1.00023227 -0.99979587 -0.99972468
 -0.99991147 -0.64711082 -1.00025506 -0.99997484 -1.22025402 -0.99973352
  0.99993062 -1.00023227 -1.08588144 -0.97951609 -0.99979594 -1.42648621
 -1.379298   -0.99982635 -1.40854285 -1.00012748 -0.99990332 -1.00003901
  1.26548263 -0.99985551 -1.00017803 -1.00000383 -0.74912649 -0.9998718
 -0.99998378 -1.00009559 -1.00045921 -0.99985669 -0.99975686 -0.42137318
  0.43088186 -1.01982673 -0.9997956  -0.67432018 -1.00014983 -0.99988807
 -0.59800064 -1.00026125 -1.00009973 -0.85348451 -0.0694888  -1.00012519
 -0.75255177 -1.00030955  0.03422077 -0.973056   -0.99995109 -1.00012221
 -0.99969996 -1.00013041 -0.9998215  -0.99968953 -1.9233492  -1.00003901
 -0.93158473 -1.0000106  -1.89933464 -0.9998023  -0.99998642 -0.99981832
 -0.99976776  0.19935951  0.49372555 -0.99995803 -1.69335885 -1.05613433
 -0.99991435 -1.00030808 -0.65265864 -0.39955402 -0.99962889  1.00007638
 -1.00035581 -0.99985097 -1.0000956  -0.99983298 -1.00023227 -1.00015243
 -0.99983952 -0.69497014 -0.34024658 -1.00012926 -1.00008726 -1.00007983
 -1.00016161 -0.99988066 -1.00020959 -0.9999114  -0.78693686 -0.99983624
 -0.99972944 -0.43725824 -0.99975509 -1.00007523 -1.78124222 -0.99980171
 -0.15227262 -0.99987424 -0.34052977 -0.9997661  -0.99977352 -0.90182132
 -0.36886902  0.21074788  0.90507574  0.99964458  2.18237148  1.00004482
  0.67446097  0.99989727 -1.00023227 -0.2986648   1.00011969  0.99975938
 -0.99962889  1.00007638  0.99995398 -0.04081865  0.99985221  0.99992505
  0.68169453  0.99980227  1.16775674  1.00020185  0.99996246  1.16262377
 -0.36015182 -0.81996622  1.00027365  1.00025266  0.99967465  1.00007638
  1.00007638  0.99989462 -0.09790195  0.29343712 -0.5144737  -0.59425477
  0.07091429  0.99981164  1.00000597  0.51540076  1.76858883 -0.3067663
  1.00010147 -0.30558283  1.00007678  0.99993386  0.99993062  0.56854555
  0.99980865  1.13811155  1.40896694  1.00019971  0.99993529  0.99971715
  0.99998275  0.99988248  0.0887691   0.35375498  1.00010552  0.99988601
  2.09881229  0.99990955  0.99962793  0.99977817  0.99975381  0.06416676
  0.9999776   1.00004091  0.33508751  1.00002685  1.93500695  0.8874137
  0.99973021  0.99989943 -0.19313789  0.99970968 -0.39376933  1.00007638
  0.99994347  1.60447332  0.99996933  0.99995129  0.99966369  1.00019422
  0.76409683 -1.00023227  0.99970042  0.86314372  2.03828846  0.88354157
  0.99999458  0.99988217 -0.6991436  -0.71323511  1.563159    0.99982557
 -0.12739856  0.99991351  0.99976223  0.92573889  0.99993062  0.99998271
  1.01223997  2.33785231  0.99974525  0.99975166  1.00015369  1.00016051
 -0.16928276  0.999781    0.99980619  1.17352935  2.04946598  0.99997226
  0.99978166  0.99988464  1.00002778  0.974374    0.45780317 -0.28653313
 -0.99962889 -0.90721907  1.00015364  1.36304632  1.00007638  1.00019743
  1.00008756  1.00028092  0.99997435  1.00008257  0.29573996  1.00008854
  0.31904489  0.3363191  -0.86678801  1.00007638  0.99995177  0.99996442
  1.00018303  1.00008089 -0.08602023  1.42394545  0.99962828  1.00024497
  1.19059515 -0.3791344  -0.2453848   1.00000232 -0.0810037   1.53630192
  1.15136714  0.99991662  0.99983161 -1.00003901 -0.97951609  0.08935724
  0.52074672  1.29865365  0.99981611  1.70249492  1.00009216  1.00007638
  1.00022357  1.12332768  0.44729244  1.32659035  0.99959884  1.27180464
 -0.5697714  -0.91594361  1.84832403  0.99982919  1.61508908  1.3037837
  0.99984747  0.99983021  1.0002021  -0.3427175   1.00007638  0.99992401
  0.99988646  1.00023696  0.9431184   0.9999304   1.15704838  1.70540312
  0.92039986  1.00001753  1.00005928  0.99990001  0.99978901  1.00005276
  1.37000999  0.99981023  1.00019798  1.08241911  0.50881486  2.09932598
  0.25710892  1.0001235   1.75815113  2.59392016  0.99990063  1.8531625
  1.20618456  0.99993062  0.79675456  2.00199651  0.83764165  0.9998375
  0.77182475  1.00007053  0.99973244  1.33063691  0.99983629  0.69450581
  1.38143626  1.0000594  -0.06292232  0.99979879].
Reshape your data either using array.reshape(-1, 1) if your data has a single feature or array.reshape(1, -1) if it contains a single sample.
